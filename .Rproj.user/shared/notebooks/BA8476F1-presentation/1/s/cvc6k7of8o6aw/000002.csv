"0","Mean <- data %>% group_by(ID) %>% summarise(Mean = mean(logFlow))"
"0","UK <- map_data(map = ""world"", region = ""UK"") "
"0",""
"0","position <- data %>% select(ID, Longitude, Latitude)"
"0","position <- unique(position)"
"0","position <- position %>% left_join(Mean, c(""ID"" = ""ID""))"
"0",""
"0","pal <- colorNumeric("
"0","  palette = ""Blues"","
"0","  domain = position$Mean)"
"0",""
"0","position %>% "
"0","  leaflet() %>% "
"0","  setView(lng = -4, lat = 57.2, zoom = 6.25) %>%"
"0","  addTiles(group = ""OSM (default)"") %>%"
"0","  addCircleMarkers(lng = ~Longitude,"
"0","                   lat = ~Latitude,"
"0","                   radius = ~ 4,"
"0","                   stroke = FALSE,"
"0","                   fill = TRUE,"
"0","                   fillOpacity =1,"
"0","                   color = ""red"","
"0","                   labelOptions = labelOptions(noHide = T, textOnly =TRUE),"
"0","                   group = ""Positions of gauging stations"") %>%"
"0","  addCircleMarkers(data = position,"
"0","    lng = ~Longitude,"
"0","    lat = ~Latitude,"
"0","    radius = ~ 2*Mean,"
"0","    stroke = FALSE,"
"0","    fill = TRUE,"
"0","    color = ~ pal(Mean),"
"0","    fillOpacity =0.8,"
"0","    popup = ~as.character(ID),"
"0","    label = ~ as.character(ID),"
"0","    labelOptions = labelOptions(noHide = F, textOnly = TRUE),"
"0","    group = ""Average Flow"""
"0","  ) %>%"
"0","  addLegend(""bottomright"", pal = pal, values = ~Mean,"
"0","    title = ""Average Flow"","
"0","#    labFormat = labelFormat(prefix = ""$""),"
"0","    opacity = 1, group = ""Average Flow"""
"0","  ) %>%"
"0","  addLayersControl("
"0","    baseGroups = c(""Map""),"
"0","    overlayGroups = c(""Positions of gauging stations"", ""Average Flow""),"
"0","    options = layersControlOptions(collapsed = FALSE)"
"0","  ) %>% "
"0","   hideGroup(""Average Flow"")%>%"
"0","  addWMSTiles(""https://basemap.nationalmap.gov/arcgis/services/USGSHydroCached/MapServer/WmsServer"", layers = ""0"", group = ""Map"")"
